<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <script type="text/javascript"  src="./vendors/jquery.min.js"  data-key="jquery" ></script>
        <script type="text/javascript"  src="./rules/niveau_puissance.js"></script>
        <script type="text/javascript"  src="./rules/competences.js"></script>
        <script type="text/javascript"  src="./rules/races.js"></script>
        <script type="text/javascript"  src="./rules/historiques.js"></script>
        <script type="text/javascript"  src="./lib/functions.js"></script>
        <link rel="stylesheet" type="text/css" media="all" href="./css/style.css" data-key="style" />
    </head>
    <body>
        <input type="text" placeholder="Nom du personnage" />
        <fieldset>
            <label>Niveau de puissance</label>
            <select id="niveau_de_puissance">
            </select>
        </fieldset>
        <fieldset>
            <label>Race</label>
            <select id="race">
                <option value="">Choix de la race</option>
            </select>
            <select id="variant" class="hidden">
                <option value="">Choix de la variante</option>
            </select>
        </fieldset>
        <fieldset>
            <label>Historique</label>
            <select id="historique">
                <option value="">Choix de l'historique</option>
            </select>
        </fieldset>
        <fieldset>
            <label>Classe</label>
            <select id="classe"></select>
        </fieldset>
        <div id="caracteristiques">
            <table>
                <tr>
                    <th>Caractéristique</th>
                    <th>Base</th>
                    <th></th>
                    <th>Bonus racial</th>
                    <th></th>
                    <th>Total</th>
                    <th>Modificateur</th>
                </tr>
                <tr class="ligne_carac">
                    <td>Force</td>
                    <td><input id="base_for" class="base_carac" type="number" value="8" min="8" max="15" /></td>
                    <td>+</td>
                    <td id="racial_for" class="racial_bonus">0</td>
                    <td>=</td>
                    <td class="base_plus_racial">8</td>
                    <td class="computed_bonus" id="bonus_for">-1</td>
                </tr>
                <tr class="ligne_carac">
                    <td>Dextérité</td>
                    <td><input id="base_dex" class="base_carac" type="number" value="8" min="8" max="15" /></td>
                    <td>+</td>
                    <td id="racial_dex" class="racial_bonus">0</td>
                    <td>=</td>
                    <td class="base_plus_racial">8</td>
                    <td class="computed_bonus" id="bonus_dex">-1</td>
                </tr>
                <tr class="ligne_carac">
                    <td>Constitution</td>
                    <td><input id="base_con" class="base_carac" type="number" value="8" min="8" max="15" /></td>
                    <td>+</td>
                    <td id="racial_con" class="racial_bonus">0</td>
                    <td>=</td>
                    <td class="base_plus_racial">8</td>
                    <td class="computed_bonus" id="bonus_con">-1</td>
                </tr>
                <tr class="ligne_carac">
                    <td>Intelligence</td>
                    <td><input id="base_int" class="base_carac" type="number" value="8" min="8" max="15" /></td>
                    <td>+</td>
                    <td id="racial_int" class="racial_bonus">0</td>
                    <td>=</td>
                    <td class="base_plus_racial">8</td>
                    <td class="computed_bonus" id="bonus_int">-1</td>
                </tr>
                <tr class="ligne_carac">
                    <td>Sagesse</td>
                    <td><input id="base_sag" class="base_carac" type="number" value="8" min="8" max="15" /></td>
                    <td>+</td>
                    <td id="racial_sag" class="racial_bonus">0</td>
                    <td>=</td>
                    <td class="base_plus_racial">8</td>
                    <td class="computed_bonus" id="bonus_sag">-1</td>
                </tr>
                <tr class="ligne_carac">
                    <td>Charisme</td>
                    <td><input id="base_cha" class="base_carac" type="number" value="8" min="8" max="15" /></td>
                    <td>+</td>
                    <td id="racial_cha" class="racial_bonus">0</td>
                    <td>=</td>
                    <td class="base_plus_racial">8</td>
                    <td class="computed_bonus" id="bonus_cha">-1</td>
                </tr>
            </table>
        </div>

        <fieldset>
            <legend>Compétences:</legend>
            <table id="competences">
                <tr id="competences_header"><th>Maitrise</th><th>Compétence</th><th>Bonus</th></tr>
            </table>
        </fieldset>

        <fieldset>
            <legend>Capacités de race:</legend>
            <div id="capacites_race"></div>
        </fieldset>
        <fieldset>
            <legend>Capacités d'historique:</legend>
            <div id="capacites_historique"></div>
        </fieldset>
        <fieldset>
            <legend>Capacités de classe:</legend>
            <div id="capacites_classe"></div>
        </fieldset>
        <fieldset>
            <legend>Dons:</legend>
            <div id="dons"></div>
        </fieldset>
        <fieldset>
            <legend>Équipement:</legend>
            <div id="equipement"></div>
        </fieldset>

    <script type="text/javascript">
        jQuery(document).ready(function(jQuery){
            creationPerso.init();
            jQuery('#niveau_de_puissance').on('change', function () {
                creationPerso.selectPuissance(jQuery(this).val());
            });
            jQuery('#race').on('change', function () {
                if (jQuery(this).val() != '') {
                    creationPerso.selectRace(jQuery(this).val());
                    if (typeof(races[jQuery(this).val()]['variants']) != 'undefined') {
                        var listVariants = jQuery('#variant').html();
                        for (i in races[jQuery(this).val()]['variants']) {
                            listVariants += '<option value="' + i + '">' + races[jQuery(this).val()]['variants'][i].label + '</option>';
                        }
                        jQuery('#variant').html(listVariants);

                        jQuery('#variant').removeClass('hidden');
                    } else {
                        jQuery('#variant').addClass('hidden');
                    }
                }
            });
            jQuery('#variant').on('change', function () {
                var race = jQuery('#race').val();
                var variant = jQuery(this).val();
                creationPerso.selectVariant(race, variant);
            });
            jQuery('.base_carac').on('input', function () {
                if (jQuery(this).val() < parseInt(jQuery(this).attr('min')) || jQuery(this).val() > parseInt(jQuery(this).attr('max'))) {
                    if (jQuery(this).val() < parseInt(jQuery(this).attr('min'))) {
                        jQuery(this).val(parseInt(jQuery(this).attr('min')));
                    } else {
                        jQuery(this).val(parseInt(jQuery(this).attr('max')));
                    }
                } 
                creationPerso.reCalculateAttributes ();
            });
            jQuery('#historique').on('change', function () {
                creationPerso.selectHistorique(jQuery(this).val());
            });
            jQuery('.checkbox_competence').on('change', function () {
                creationPerso.recalculCompetences();
            });
        });
    </script>
    </body>
</html>
